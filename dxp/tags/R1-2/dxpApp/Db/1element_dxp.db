# 1element.db

# Database for 1 element detector with DXP4C or DXP2X MCAs from XIA.

grecord(dfanout,"$(P)EraseAll") {
        field(VAL, "1")
        field(OUTA,"$(P)mca1.ERAS  CA MS")
}

grecord(dfanout,"$(P)EraseStart") {
        field(VAL, "1")
        field(OUTA,"$(P)mca1.ERST  CA MS")
        field(OUTF,"$(P)AcquireBusy PP MS")
        field(FLNK,"$(P)SetClientWait")
}

grecord(dfanout,"$(P)StartAll") {
        field(VAL, "1")
        field(OUTA,"$(P)mca1.STRT  CA MS")
        field(OUTF,"$(P)AcquireBusy PP MS")
        field(FLNK,"$(P)SetClientWait")
}

grecord(busy,"$(P)AcquireBusy") {
}

grecord(dfanout,"$(P)StopAll") {
        field(VAL, "1")
        field(OUTA,"$(P)mca1.STOP  CA MS")
}

grecord(dfanout,"$(P)PresetReal") {
        field(DOL, "$(P)PresetReal.VAL")
        field(OMSL, "closed_loop")
        field(OUTA,"$(P)mca1.PRTM  CA MS")
        field(PREC, "2")
}

grecord(dfanout,"$(P)PresetReal1") {
        field(DOL, "$(P)PresetReal.VAL")
        field(OMSL, "closed_loop")
        field(OUTC,"$(P)mca1.PRTM CA MS")
        field(PREC, "2")
}

grecord(dfanout,"$(P)PresetLive") {
        field(DOL, "$(P)PresetLive.VAL")
        field(OMSL, "closed_loop")
        field(OUTA,"$(P)mca1.PLTM  CA MS")
        field(PREC, "2")
}

grecord(calcout,"$(P)Acquiring") {
        field(CALC, "(A)>0")
        field(INPA,"$(P)mca1.ACQG  CP MS")
        field(OOPT,"Transition To Zero")
        field(OUT, "$(P)AcquireDone.PROC PP MS")
}

grecord(dfanout,"$(P)AcquireDone") {
        field(VAL, "0")
        field(OUTA,"$(P)AcquireBusy.VAL PP MS")
}

grecord(calcout,"$(P)ElapsedReal") {
        field(CALC, "A")
        field(INPA,"$(P)mca1.ERTM  CP MS")
        field(PREC, "2")
}

grecord(calcout,"$(P)ElapsedLive") {
        field(CALC, "A")
        field(INPA,"$(P)mca1.ELTM  CP MS")
        field(PREC, "2")
}

grecord(calcout,"$(P)DeadTime") {
        field(CALC, "A")
        field(INPA,"$(P)mca1.IDTIM  CP MS")
        field(PREC, "2")
}


grecord(dfanout,"$(P)ReadAll") {
        field(SCAN,"1 second")
        field(DISV,"0")
        field(SDIS,"$(P)Acquiring NPP NMS")
        field(VAL, "1")
        field(OUTA,"$(P)mca1.READ  CA MS")
}

grecord(dfanout,"$(P)ReadDXPs") {
        field(SCAN,"1 second")
        field(VAL, "1")
        field(OUTA,"$(P)dxp1.PROC  CA MS")
}

grecord(dfanout,"$(P)dxpCopyGain") {
        field(DOL, "$(P)dxp1.GAIN NPP NMS")
        field(OMSL,"closed_loop")
#        field(OUTA,"$(P)dxp1.GAIN  CA MS")
}

grecord(dfanout,"$(P)dxpCopyEmax") {
        field(DOL, "$(P)dxp1.EMAX NPP NMS")
        field(OMSL,"closed_loop")
#        field(OUTA,"$(P)dxp1.EMAX  CA MS")
}


grecord(dfanout,"$(P)dxpCopyPktm") {
        field(DOL, "$(P)dxp1.PKTM NPP NMS")
        field(OMSL,"closed_loop")
#        field(OUTA,"$(P)dxp1.PKTM  CA MS")
}

grecord(dfanout,"$(P)dxpCopyFippi") {
        field(DOL, "$(P)dxp1.FIPPI NPP NMS")
        field(OMSL,"closed_loop")
#        field(OUTA,"$(P)dxp1.FIPPI  CA MS")
}

grecord(dfanout,"$(P)StatusAll") {
        field(SCAN,".5 second")
        field(DISV,"0")
        field(SDIS,"$(P)Acquiring NPP NMS")
        field(VAL, "1")
        field(OUTA,"$(P)mca1.PROC  CA MS")
}


# These records are for waiting for IDL or other clients
grecord(bo,"$(P)EnableClientWait") {
        field(ZNAM,"Disable")
        field(ONAM,"Enable")
}

grecord(bo,"$(P)SetClientWait") {
        field(DISV,"0")
        field(SDIS,"$(P)EnableClientWait NPP NMS")
        field(OMSL,"closed_loop")
        field(DOL,"1")
        field(OUT,"$(P)ClientWait PP MS")
}

grecord(busy,"$(P)ClientWait") {
}

# These records are not used, but they must exist for the IDL EPICS_MED class
grecord(ao,"$(P)Dwell") {}
grecord(bo,"$(P)ChannelAdvance") {}
grecord(ao,"$(P)Prescale") {}
